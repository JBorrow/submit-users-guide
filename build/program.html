
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Available Software &#8212; subMIT v0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/groundwork.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running and Batch jobs" href="running.html" />
    <link rel="prev" title="Things that work and things that do not" href="working.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="running.html" title="Running and Batch jobs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="working.html" title="Things that work and things that do not"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">subMIT v0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Available Software</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="available-software">
<h1>Available Software<a class="headerlink" href="#available-software" title="Permalink to this headline">¶</a></h1>
<div class="section" id="native-system">
<h2>Native system<a class="headerlink" href="#native-system" title="Permalink to this headline">¶</a></h2>
<p>All of the submit machines come with several tools to help you get started with your work. A few examples are shown below:</p>
<ol class="arabic simple">
<li><p>Languages:</p></li>
</ol>
<ul class="simple">
<li><p>python</p></li>
<li><p>c++</p></li>
<li><p>Java</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Tools:</p></li>
</ol>
<ul class="simple">
<li><p>XRootd</p></li>
<li><p>GFAL</p></li>
</ul>
<p>For more complicated workflows, there are several options on how to proceed. Many environments can be set up through CVFMS provided by CERN. If you need more control of the environment, either conda or dockers are commonly used and well supported. For more information see the sections below.</p>
</div>
<div class="section" id="cvmfs">
<h2>CVMFS<a class="headerlink" href="#cvmfs" title="Permalink to this headline">¶</a></h2>
<p>The CernVM File System (CVMFS) provides a scalable, reliable and low- maintenance software distribution service. It was developed to assist High Energy Physics (HEP) collaborations to deploy software on the worldwide- distributed computing infrastructure used to run data processing applications. CernVM-FS is implemented as a POSIX read-only file system in user space (a FUSE module). Files and directories are hosted on standard web servers and mounted in the universal namespace /cvmfs.</p>
<p>More documentation on CVMFS can be found here: <a class="reference external" href="https://cernvm.cern.ch/fs/">CVMFS</a></p>
<p>In order to initialize CVMFS on submit machines you can simply use the command below:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> /cvmfs/cms.cern.ch/cmsset_default.sh
</pre></div>
</div>
<p>Once CVMFS has been sourced you can see the options in /cvmfs. If you want to use ROOT or any other CMS specific tools you can also download CMSSW releases and work within a CMS environment. A simple example is shown below:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>cmsrel CMSSW_10_2_13
<span class="nb">cd</span> CMSSW_10_2_13/src
cmsenv
</pre></div>
</div>
<p>Once the cms environment is set up, ROOT is now available to you as well</p>
</div>
<div class="section" id="conda">
<h2>Conda<a class="headerlink" href="#conda" title="Permalink to this headline">¶</a></h2>
<p>Conda is an open source package management system and environment management system. We can use this to set up consistent environments and manage the package dependencies for various applications. Below is an example to set up a python3 environment for working with coffea and dask.</p>
<p>### Coffea installation with Miniconda
For installing Miniconda, see also <a class="reference external" href="https://hackmd.io/GkiNxag0TUmHnnCiqdND1Q#Local-or-remote">https://hackmd.io/GkiNxag0TUmHnnCiqdND1Q#Local-or-remote</a></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
<span class="c1"># Run and follow instructions on screen</span>
bash Miniconda3-latest-Linux-x86_64.sh
</pre></div>
</div>
<p>NOTE: always make sure that conda, python, and pip point to local Miniconda installation (<cite>which conda</cite> etc.).</p>
<p>You can either use the default environment`base` or create a new one:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># create new environment with python 3.7, e.g. environment of name `coffea`</span>
conda create --name coffea <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.7
<span class="c1"># activate environment `coffea`</span>
conda activate coffea
</pre></div>
</div>
<p>Install coffea, xrootd, and more. SUEP analysis uses Fastjet with awkward array input (fastjet&gt;=3.3.4.0rc8) and vector:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip install git+https://github.com/CoffeaTeam/coffea.git <span class="c1">#latest published release with `pip install coffea`</span>
conda install -c conda-forge xrootd
conda install -c conda-forge ca-certificates
conda install -c conda-forge ca-policy-lcg
conda install -c conda-forge dask-jobqueue
conda install -c anaconda bokeh
conda install -c conda-forge <span class="s1">&#39;fsspec&gt;=0.3.3&#39;</span>
conda install dask
conda install pytables
pip install --pre fastjet
pip install vector
</pre></div>
</div>
</div>
<div class="section" id="containers">
<h2>Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h2>
<p>Containers are becoming commonplace in scientific workflows. Submit offers access to containers through Singularity images provided through CVMFS. This section will give a short example on how to enter into a singularity container to run your framework. For more information on dockers see the site below:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://docs.docker.com/engine/reference/commandline/build/">docker</a></p></li>
</ol>
<p>For this example, we will use the coffea-base singularity image based on the following image:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/CoffeaTeam/docker-coffea-base">coffea-base</a></p></li>
</ol>
<p>Entering into the singularity environment is easy once you have sourced CVMFS. You can simply do the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>singularity shell -B <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>:/work /cvmfs/unpacked.cern.ch/registry.hub.docker.com/coffeateam/coffea-dask:latest
</pre></div>
</div>
<p>Now you should be in a singularity environment. To test you try to import a non-native package like coffea in python:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python3 -c <span class="s2">&quot;import coffea&quot;</span>
</pre></div>
</div>
<p>The command above naturally binds the PWD and work directory. If you need to specify another area to bind you can do the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">SINGULARITY_BIND</span><span class="o">=</span><span class="s2">&quot;/mnt&quot;</span>
</pre></div>
</div>
<p>Now you can run in many different environments that are available in singularity images through CVMFS.</p>
</div>
<div class="section" id="jupyterhub">
<h2>JupyterHub:<a class="headerlink" href="#jupyterhub" title="Permalink to this headline">¶</a></h2>
<p>In addition to the tools above, you have access to Jupyter Notebooks through a JupyterHub set up at submit. You can log in below:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://submit00.mit.edu/jupyter">JupyterHub</a></p></li>
</ol>
<p>This JupyterHub is set up through the submit machines meaning that you have access to all of your data through jupyter notebooks. You will have access to basic python2 and python3 configurations. In additionif you need a more complex environment, you can run your notebooks in any conda environment that you have set up. This allows you to create the exact environement you need for your projects. An example on how to set up a conda environment is shown above.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/submit.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Available Software</a><ul>
<li><a class="reference internal" href="#native-system">Native system</a></li>
<li><a class="reference internal" href="#cvmfs">CVMFS</a></li>
<li><a class="reference internal" href="#conda">Conda</a></li>
<li><a class="reference internal" href="#containers">Containers</a></li>
<li><a class="reference internal" href="#jupyterhub">JupyterHub:</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="working.html"
                        title="previous chapter">Things that work and things that do not</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="running.html"
                        title="next chapter">Running and Batch jobs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/program.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="running.html" title="Running and Batch jobs"
             >next</a> |</li>
        <li class="right" >
          <a href="working.html" title="Things that work and things that do not"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">subMIT v0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Available Software</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Chad Freer, Christoph Paus.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>